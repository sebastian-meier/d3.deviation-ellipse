var devellipse=function(n){function r(n){return e=t(e,n)}function t(n,r){var t={},a;for(a in n)t[a]=n[a];for(a in r)t[a]=r[a];return t}function a(){}var e={level:.9,x:function(n){return n[0]},y:function(n){return n[1]}},u={rx:null,ry:null,cx:null,cy:null,orient:null};r(n),a.data=function(n){for(var r=[],t=[],a=[],u=[],o=0;o<n.length;o++)r.push(e.x(n[o])),t.push(e.y(n[o])),u.push({x:e.x(n[o]),y:e.y(n[o])}),a.push(n[o]);var c=d3.deviation(r),v=d3.mean(r),x=d3.extent(r),d=d3.mean(t),f=d3.deviation(t),h=d3.extent(t),s=jStat.corrcoeff(r,t),m,M=s*c*f,y=[[c*c,M],[M,f*f]],b=numeric.eig(y),q=Math.sqrt(jStat.chisquare.inv(e.level,2)),p=i(b.lambda.x),g=l(b.lambda.x),j=c>f?Math.sqrt(b.lambda.x[p])*q:Math.sqrt(b.lambda.x[g])*q,I=f>c?Math.sqrt(b.lambda.x[p])*q:Math.sqrt(b.lambda.x[g])*q,P=b.E.x[p],S=Math.atan2(P[1],P[0]);0>S&&(S+=2*Math.PI);var E=-(180*S/Math.PI)+90;return Math.abs(E)<135&&(E-=90),m={rx:j,ry:I,cx:v,cy:d,orient:E}};var i=function(n){var r=n[0],t=0;for(var a in n)n[a]>r&&(r=n[a],t=a);return t},l=function(n){var r=n[0],t=0;for(var a in n)n[a]<r&&(r=n[a],t=a);return t};return a};